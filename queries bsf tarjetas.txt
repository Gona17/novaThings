TARJETAS BSF

query viejo con AS:

SELECT DISTINCT rc.nro_cuit as id_persona,CAST(rc.Id_Cliente_Core AS STRING),ct.nro_ruc as nro_cuenta,CAST(ct.nro_bco_sucursal AS INT) AS id_banco_sucursal_cuenta,ct.den_ruc AS denominacion_razon_social,ct.den_calle AS domicilio_cliente,ct.plod AS domicilio_cliente_piso,ct.den_localidad AS domicilio_cliente_localidad,ct.den_barrio AS domicilio_cliente_barrio,ct.nro_telefono AS nro_telefono_cliente,ct.tipo_doc AS tipo_documento_cliente,ct.nro_doc AS nro_documento_cliente,ct.nro_cedula AS nro_cedula_cliente,ct.cod_provincia AS id_provincia_cliente,ct.cod_postal AS cod_postal_cliente,CAST(ct.cod_zona AS INT) AS id_zona_geo_cliente,ct.tipo_cta_1_banco AS tipo_cuenta_bcria_1,ct.nro_cta_1_banco AS nro_cuenta_bcria_1,ct.tipo_cta_2_banco AS tipo_cuenta_bcria_2,ct.nro_cta_2_banco AS nro_cuenta_bcria_2,ct.marca_deb_cta AS marca_debito_cuenta,CAST(ct.grupo AS INT) AS id_grupo_liq,ct.reservado_uso_casa AS filler_credencial_1,CAST(ct.imp_lim_cred AS BIGINT) AS mto_limite_credito,CAST(ct.cod_mtu AS INT) AS id_mtu,CAST(ct.nro_bco_suc_ant AS INT) AS id_banco_sucursal_cuenta_anterior,CAST(ct.estado_operativo AS INT) AS id_estado_operativo,CAST(ct.est_saldo AS INT) AS id_estado_saldo,ct.cod_producto AS id_producto,CAST(ct.cod_afinidad AS INT) AS id_afinidad,CAST(ct.cod_gtos_adm AS INT) AS id_gastos_administrativos,ct.fult_act AS fecha_ult_actualizacion,ct.abm AS id_estado_cuenta,CAST(ct.nro_refer AS INT) AS nro_referencia,CAST(ct.nro_promotor_alta AS INT) AS nro_promotor,ct.cuit AS nro_cuit,CAST(ct.cod_cond_tribut AS INT) AS id_condicion_tributaria,CAST(ct.tipo_modalidad AS INT) AS id_modalidad,CAST(concat(substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), 1, 9), '.', substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), -2)) AS DECIMAL(11,2)) AS mto_garantia,CAST(ct.nro_retorno AS INT) AS nro_retorno_agro,ct.marca_renov AS marca_renovacion,CAST(ct.cod_nivel_alerta AS INT) AS id_nivel_alerta,ct.nro_tarjeta AS nro_tarjeta,ct.idtt AS id_titularidad_tarjeta,ct.den_tarjeta_plastico AS nombre_plastico_tarjeta,ct.filler AS filler_credencial_2,ct.den_tarjeta_adicional AS datos_adicionales_plastico,ct.sexo AS id_sexo,ct.marca_hijos AS tiene_hijos,ct.est_civil AS id_estado_civil,ct.fnacimiento AS fecha_nacimiento_cliente,CAST(ct.cod_ocupacion AS INT) AS id_ocupacion,CAST(ct.cod_dur_tarjeta AS INT) AS id_duracion_tarjeta,CAST(ct.cod_categ_tarjeta AS INT) AS id_categoria_tarjeta,ct.fdesde AS fecha_inicio_vigencia,ct.fhasta AS fecha_fin_vigencia,ct.nro_tarjeta_nuevo AS nro_tarjeta_nuevo,ct.marca_grab_tarjeta AS graba_tarjeta,CAST(ct.por_bon_emi_ren AS INT) AS porc_bonificacion_emision_renov,CAST(ct.can_cuota_emi_ren AS INT) AS q_cuotas_emision_renov,CAST(ct.cod_per_bonif AS INT) AS id_periodo_bonificacion,CAST(ct.mot_alta_boletin AS INT) AS id_motivo_alta_boletin,ct.denom_aval AS filler_credencial_3,ct.ususeg AS id_ult_usuario,ct.marca_emis_pin AS emitio_pin,CAST(ct.imp_lim_cpra AS BIGINT) AS mto_limite_compra,CAST(ct.por_lim_adelanto AS FLOAT) AS porc_limite_adelanto,ct.nro_tel_2 AS nro_telefono_cliente_2,CAST(ct.cod_vendedor AS INT) AS id_vendedor,CAST(ct.suc_cta_bco AS INT) AS id_sucursal_cuenta,ct.cbu AS cbu,ct.mail AS mail,ct.nro_doc_extr AS nro_documento_cliente_extranjero,ct.mar_habil AS es_cuenta_habilitada,ct.fbloq AS fecha_bloqueo_cuenta,ct.fdesbloq AS fecha_desbloqueo_cuenta,ct.nro_cel_cpra AS nro_celular_compras,ct.tipo_reg AS fuente_registro FROM de_bsf_2cur.cliente_homologado rc INNER JOIN de_bsf_2cur.ft_tarjetas_credencial_cuentas ft ON rc.id_cliente_core = CAST(ft.id_cliente_core AS BIGINT) INNER JOIN de_bsf_1raw.cred_tarjetas ct ON ft.Nro_Cuenta  = ct.nro_ruc




query nueva con AS:

WITH cliente_cuentas AS (SELECT rc.nro_cuit as id_persona,CAST(rc.Id_Cliente_Core AS STRING),ft.nro_cuenta, MAX(ft.fecha_ult_actualizacion) FROM de_${banco}_2cur.cliente_homologado rc INNER JOIN de_${banco}_2cur.ft_tarjetas_credencial_cuentas ft ON rc.id_cliente_core = CAST(ft.id_cliente_core AS BIGINT)  GROUP BY rc.nro_cuit as id_persona,CAST(rc.Id_Cliente_Core AS STRING), ft.nro_cuenta ) SELECT DISTINCT rc.nro_cuit as id_persona,CAST(rc.Id_Cliente_Core AS STRING),ct.nro_ruc as nro_cuenta,CAST(ct.nro_bco_sucursal AS INT) AS id_banco_sucursal_cuenta,ct.den_ruc AS denominacion_razon_social,ct.den_calle AS domicilio_cliente,ct.plod AS domicilio_cliente_piso,ct.den_localidad AS domicilio_cliente_localidad,ct.den_barrio AS domicilio_cliente_barrio,ct.nro_telefono AS nro_telefono_cliente,ct.tipo_doc AS tipo_documento_cliente,ct.nro_doc AS nro_documento_cliente,ct.nro_cedula AS nro_cedula_cliente,ct.cod_provincia AS id_provincia_cliente,ct.cod_postal AS cod_postal_cliente,CAST(ct.cod_zona AS INT) AS id_zona_geo_cliente,ct.tipo_cta_1_banco AS tipo_cuenta_bcria_1,ct.nro_cta_1_banco AS nro_cuenta_bcria_1,ct.tipo_cta_2_banco AS tipo_cuenta_bcria_2,ct.nro_cta_2_banco AS nro_cuenta_bcria_2,ct.marca_deb_cta AS marca_debito_cuenta,CAST(ct.grupo AS INT) AS id_grupo_liq,ct.reservado_uso_casa AS filler_credencial_1,CAST(ct.imp_lim_cred AS BIGINT) AS mto_limite_credito,CAST(ct.cod_mtu AS INT) AS id_mtu,CAST(ct.nro_bco_suc_ant AS INT) AS id_banco_sucursal_cuenta_anterior,CAST(ct.estado_operativo AS INT) AS id_estado_operativo,CAST(ct.est_saldo AS INT) AS id_estado_saldo,ct.cod_producto AS id_producto,CAST(ct.cod_afinidad AS INT) AS id_afinidad,CAST(ct.cod_gtos_adm AS INT) AS id_gastos_administrativos,ct.fult_act AS fecha_ult_actualizacion,ct.abm AS id_estado_cuenta,CAST(ct.nro_refer AS INT) AS nro_referencia,CAST(ct.nro_promotor_alta AS INT) AS nro_promotor,ct.cuit AS nro_cuit,CAST(ct.cod_cond_tribut AS INT) AS id_condicion_tributaria,CAST(ct.tipo_modalidad AS INT) AS id_modalidad,CAST(concat(substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), 1, 9), '.', substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), -2)) AS DECIMAL(11,2)) AS mto_garantia,CAST(ct.nro_retorno AS INT) AS nro_retorno_agro,ct.marca_renov AS marca_renovacion,CAST(ct.cod_nivel_alerta AS INT) AS id_nivel_alerta,ct.nro_tarjeta AS nro_tarjeta,ct.idtt AS id_titularidad_tarjeta,ct.den_tarjeta_plastico AS nombre_plastico_tarjeta,ct.filler AS filler_credencial_2,ct.den_tarjeta_adicional AS datos_adicionales_plastico,ct.sexo AS id_sexo,ct.marca_hijos AS tiene_hijos,ct.est_civil AS id_estado_civil,ct.fnacimiento AS fecha_nacimiento_cliente,CAST(ct.cod_ocupacion AS INT) AS id_ocupacion,CAST(ct.cod_dur_tarjeta AS INT) AS id_duracion_tarjeta,CAST(ct.cod_categ_tarjeta AS INT) AS id_categoria_tarjeta,ct.fdesde AS fecha_inicio_vigencia,ct.fhasta AS fecha_fin_vigencia,ct.nro_tarjeta_nuevo AS nro_tarjeta_nuevo,ct.marca_grab_tarjeta AS graba_tarjeta,CAST(ct.por_bon_emi_ren AS INT) AS porc_bonificacion_emision_renov,CAST(ct.can_cuota_emi_ren AS INT) AS q_cuotas_emision_renov,CAST(ct.cod_per_bonif AS INT) AS id_periodo_bonificacion,CAST(ct.mot_alta_boletin AS INT) AS id_motivo_alta_boletin,ct.denom_aval AS filler_credencial_3,ct.ususeg AS id_ult_usuario,ct.marca_emis_pin AS emitio_pin,CAST(ct.imp_lim_cpra AS BIGINT) AS mto_limite_compra,CAST(ct.por_lim_adelanto AS FLOAT) AS porc_limite_adelanto,ct.nro_tel_2 AS nro_telefono_cliente_2,CAST(ct.cod_vendedor AS INT) AS id_vendedor,CAST(ct.suc_cta_bco AS INT) AS id_sucursal_cuenta,ct.cbu AS cbu,ct.mail AS mail,ct.nro_doc_extr AS nro_documento_cliente_extranjero,ct.mar_habil AS es_cuenta_habilitada,ct.fbloq AS fecha_bloqueo_cuenta,ct.fdesbloq AS fecha_desbloqueo_cuenta,ct.nro_cel_cpra AS nro_celular_compras,ct.tipo_reg AS fuente_registro FROM cliente_cuentas rc INNER JOIN de_${banco}_1raw.cred_tarjetas ct ON rc.nro_cuenta = ct.nro_ruc




Vieja sin AS:

SELECT DISTINCT rc.nro_cuit,CAST(rc.Id_Cliente_Core AS STRING),ct.nro_ruc,CAST(ct.nro_bco_sucursal AS INT),ct.den_ruc,ct.den_calle,ct.plod,ct.den_localidad,ct.den_barrio,ct.nro_telefono,ct.tipo_doc,ct.nro_doc,ct.nro_cedula,ct.cod_provincia,ct.cod_postal,CAST(ct.cod_zona AS INT),ct.tipo_cta_1_banco,ct.nro_cta_1_banco,ct.tipo_cta_2_banco,ct.nro_cta_2_banco,ct.marca_deb_cta,CAST(ct.grupo AS INT),ct.reservado_uso_casa,CAST(ct.imp_lim_cred AS BIGINT),CAST(ct.cod_mtu AS INT),CAST(ct.nro_bco_suc_ant AS INT),CAST(ct.estado_operativo AS INT),CAST(ct.est_saldo AS INT),ct.cod_producto,CAST(ct.cod_afinidad AS INT),CAST(ct.cod_gtos_adm AS INT),ct.fult_act,ct.abm,CAST(ct.nro_refer AS INT),CAST(ct.nro_promotor_alta AS INT),ct.cuit,CAST(ct.cod_cond_tribut AS INT),CAST(ct.tipo_modalidad AS INT),CAST(concat(substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), 1, 9), '.', substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), -2)) AS DECIMAL(11,2)) a,CAST(ct.nro_retorno AS INT),ct.marca_renov,CAST(ct.cod_nivel_alerta AS INT),ct.nro_tarjeta,ct.idtt,ct.den_tarjeta_plastico,ct.filler,ct.den_tarjeta_adicional,ct.sexo,ct.marca_hijos,ct.est_civil,ct.fnacimiento,CAST(ct.cod_ocupacion AS INT),CAST(ct.cod_dur_tarjeta AS INT),CAST(ct.cod_categ_tarjeta AS INT),ct.fdesde,ct.fhasta,ct.nro_tarjeta_nuevo,ct.marca_grab_tarjeta,CAST(ct.por_bon_emi_ren AS INT),CAST(ct.can_cuota_emi_ren AS INT),CAST(ct.cod_per_bonif AS INT),CAST(ct.mot_alta_boletin AS INT),ct.denom_aval,ct.ususeg,ct.marca_emis_pin,CAST(ct.imp_lim_cpra AS BIGINT),CAST(ct.por_lim_adelanto AS FLOAT),ct.nro_tel_2,CAST(ct.cod_vendedor AS INT),CAST(ct.suc_cta_bco AS INT),ct.cbu,ct.mail,ct.nro_doc_extr,ct.mar_habil,ct.fbloq,ct.fdesbloq,ct.nro_cel_cpra,ct.tipo_reg FROM de_${banco}_2cur.cliente_homologado rc INNER JOIN de_${banco}_2cur.ft_tarjetas_credencial_cuentas ft ON rc.id_cliente_core = CAST(ft.id_cliente_core AS BIGINT) INNER JOIN de_${banco}_1raw.cred_tarjetas ct ON ft.Nro_Cuenta  = ct.nro_ruc




Nueva sin AS:

WITH cliente_cuentas AS (
    SELECT rc.nro_cuit
         , rc.id_cliente_core
         , ft.nro_cuenta
         , MAX(ft.fecha_ult_actualizacion)
      FROM de_bsf_2cur.cliente_homologado rc 
INNER JOIN de_bsf_2cur.ft_tarjetas_credencial_cuentas ft 
        ON rc.id_cliente_core = CAST(ft.id_cliente_core AS BIGINT)  
  GROUP BY rc.nro_cuit
         , rc.id_cliente_core
         , ft.nro_cuenta )
    SELECT DISTINCT
           rc.nro_cuit,CAST(rc.Id_Cliente_Core AS STRING),ct.nro_ruc,CAST(ct.nro_bco_sucursal AS INT),ct.den_ruc,ct.den_calle,ct.plod,ct.den_localidad,ct.den_barrio,ct.nro_telefono,ct.tipo_doc,ct.nro_doc,ct.nro_cedula,ct.cod_provincia,ct.cod_postal,CAST(ct.cod_zona AS INT),ct.tipo_cta_1_banco,ct.nro_cta_1_banco,ct.tipo_cta_2_banco,ct.nro_cta_2_banco,ct.marca_deb_cta,CAST(ct.grupo AS INT),ct.reservado_uso_casa,CAST(ct.imp_lim_cred AS BIGINT),CAST(ct.cod_mtu AS INT),CAST(ct.nro_bco_suc_ant AS INT),CAST(ct.estado_operativo AS INT),CAST(ct.est_saldo AS INT),ct.cod_producto,CAST(ct.cod_afinidad AS INT),CAST(ct.cod_gtos_adm AS INT),ct.fult_act,ct.abm,CAST(ct.nro_refer AS INT),CAST(ct.nro_promotor_alta AS INT),ct.cuit,CAST(ct.cod_cond_tribut AS INT),CAST(ct.tipo_modalidad AS INT),CAST(concat(substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), 1, 9), '.', substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), -2)) AS DECIMAL(11,2)) a,CAST(ct.nro_retorno AS INT),ct.marca_renov,CAST(ct.cod_nivel_alerta AS INT),ct.nro_tarjeta,ct.idtt,ct.den_tarjeta_plastico,ct.filler,ct.den_tarjeta_adicional,ct.sexo,ct.marca_hijos,ct.est_civil,ct.fnacimiento,CAST(ct.cod_ocupacion AS INT),CAST(ct.cod_dur_tarjeta AS INT),CAST(ct.cod_categ_tarjeta AS INT),ct.fdesde,ct.fhasta,ct.nro_tarjeta_nuevo,ct.marca_grab_tarjeta,CAST(ct.por_bon_emi_ren AS INT),CAST(ct.can_cuota_emi_ren AS INT),CAST(ct.cod_per_bonif AS INT),CAST(ct.mot_alta_boletin AS INT),ct.denom_aval,ct.ususeg,ct.marca_emis_pin,CAST(ct.imp_lim_cpra AS BIGINT),CAST(ct.por_lim_adelanto AS FLOAT),ct.nro_tel_2,CAST(ct.cod_vendedor AS INT),CAST(ct.suc_cta_bco AS INT),ct.cbu,ct.mail,ct.nro_doc_extr,ct.mar_habil,ct.fbloq,ct.fdesbloq,ct.nro_cel_cpra,ct.tipo_reg 
      FROM cliente_cuentas rc  
INNER JOIN de_bsf_1raw.cred_tarjetas ct 
        ON rc.nro_cuenta = ct.nro_ruc


WITH cliente_cuentas AS (SELECT rc.nro_cuit as id_persona,CAST(rc.Id_Cliente_Core AS STRING),ft.nro_cuenta, MAX(ft.fecha_ult_actualizacion) FROM (de_${banco}_2cur.cliente_homologado rc) INNER JOIN de_${banco}_2cur.ft_tarjetas_credencial_cuentas ft ON rc.id_cliente_core = CAST(ft.id_cliente_core AS BIGINT)  GROUP BY (rc.nro_cuit as id_persona),CAST(rc.Id_Cliente_Core AS STRING), ft.nro_cuenta) SELECT DISTINCT rc.nro_cuit as id_persona,CAST(rc.Id_Cliente_Core AS STRING),ct.nro_ruc as nro_cuenta,CAST(ct.nro_bco_sucursal AS INT) AS id_banco_sucursal_cuenta,ct.den_ruc AS denominacion_razon_social,ct.den_calle AS domicilio_cliente,ct.plod AS domicilio_cliente_piso,ct.den_localidad AS domicilio_cliente_localidad,ct.den_barrio AS domicilio_cliente_barrio,ct.nro_telefono AS nro_telefono_cliente,ct.tipo_doc AS tipo_documento_cliente,ct.nro_doc AS nro_documento_cliente,ct.nro_cedula AS nro_cedula_cliente,ct.cod_provincia AS id_provincia_cliente,ct.cod_postal AS cod_postal_cliente,CAST(ct.cod_zona AS INT) AS id_zona_geo_cliente,ct.tipo_cta_1_banco AS tipo_cuenta_bcria_1,ct.nro_cta_1_banco AS nro_cuenta_bcria_1,ct.tipo_cta_2_banco AS tipo_cuenta_bcria_2,ct.nro_cta_2_banco AS nro_cuenta_bcria_2,ct.marca_deb_cta AS marca_debito_cuenta,CAST(ct.grupo AS INT) AS id_grupo_liq,ct.reservado_uso_casa AS filler_credencial_1,CAST(ct.imp_lim_cred AS BIGINT) AS mto_limite_credito,CAST(ct.cod_mtu AS INT) AS id_mtu,CAST(ct.nro_bco_suc_ant AS INT) AS id_banco_sucursal_cuenta_anterior,CAST(ct.estado_operativo AS INT) AS id_estado_operativo,CAST(ct.est_saldo AS INT) AS id_estado_saldo,ct.cod_producto AS id_producto,CAST(ct.cod_afinidad AS INT) AS id_afinidad,CAST(ct.cod_gtos_adm AS INT) AS id_gastos_administrativos,ct.fult_act AS fecha_ult_actualizacion,ct.abm AS id_estado_cuenta,CAST(ct.nro_refer AS INT) AS nro_referencia,CAST(ct.nro_promotor_alta AS INT) AS nro_promotor,ct.cuit AS nro_cuit,CAST(ct.cod_cond_tribut AS INT) AS id_condicion_tributaria,CAST(ct.tipo_modalidad AS INT) AS id_modalidad,CAST(concat(substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), 1, 9), '.', substr(concat(substr(ct.imp_garantia, 1, 10), CASE substr(ct.imp_garantia, -1) WHEN 'S' THEN '3' ELSE substr(ct.imp_garantia, -1) END), -2)) AS DECIMAL(11,2)) AS mto_garantia,CAST(ct.nro_retorno AS INT) AS nro_retorno_agro,ct.marca_renov AS marca_renovacion,CAST(ct.cod_nivel_alerta AS INT) AS id_nivel_alerta,ct.nro_tarjeta AS nro_tarjeta,ct.idtt AS id_titularidad_tarjeta,ct.den_tarjeta_plastico AS nombre_plastico_tarjeta,ct.filler AS filler_credencial_2,ct.den_tarjeta_adicional AS datos_adicionales_plastico,ct.sexo AS id_sexo,ct.marca_hijos AS tiene_hijos,ct.est_civil AS id_estado_civil,ct.fnacimiento AS fecha_nacimiento_cliente,CAST(ct.cod_ocupacion AS INT) AS id_ocupacion,CAST(ct.cod_dur_tarjeta AS INT) AS id_duracion_tarjeta,CAST(ct.cod_categ_tarjeta AS INT) AS id_categoria_tarjeta,ct.fdesde AS fecha_inicio_vigencia,ct.fhasta AS fecha_fin_vigencia,ct.nro_tarjeta_nuevo AS nro_tarjeta_nuevo,ct.marca_grab_tarjeta AS graba_tarjeta,CAST(ct.por_bon_emi_ren AS INT) AS porc_bonificacion_emision_renov,CAST(ct.can_cuota_emi_ren AS INT) AS q_cuotas_emision_renov,CAST(ct.cod_per_bonif AS INT) AS id_periodo_bonificacion,CAST(ct.mot_alta_boletin AS INT) AS id_motivo_alta_boletin,ct.denom_aval AS filler_credencial_3,ct.ususeg AS id_ult_usuario,ct.marca_emis_pin AS emitio_pin,CAST(ct.imp_lim_cpra AS BIGINT) AS mto_limite_compra,CAST(ct.por_lim_adelanto AS FLOAT) AS porc_limite_adelanto,ct.nro_tel_2 AS nro_telefono_cliente_2,CAST(ct.cod_vendedor AS INT) AS id_vendedor,CAST(ct.suc_cta_bco AS INT) AS id_sucursal_cuenta,ct.cbu AS cbu,ct.mail AS mail,ct.nro_doc_extr AS nro_documento_cliente_extranjero,ct.mar_habil AS es_cuenta_habilitada,ct.fbloq AS fecha_bloqueo_cuenta,ct.fdesbloq AS fecha_desbloqueo_cuenta,ct.nro_cel_cpra AS nro_celular_compras,ct.tipo_reg AS fuente_registro FROM cliente_cuentas rc INNER JOIN de_${banco}_1raw.cred_tarjetas ct ON rc.nro_cuenta = ct.nro_ruc
